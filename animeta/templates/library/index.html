{% extends 'library/_base.html' %}

{% macro status_text(status) %}
{%- if status == 'watching' %}보는 중
{%- elif status == 'finished' %}완료
{%- elif status == 'suspended' %}중단
{%- elif status == 'interested' %}관심
{%- endif -%}
{% endmacro %}

{% macro render_status(item) %}
{% if item.status == 'watching' %}
    {% if item.progress %}
        {{ item.progress }}화
    {% else %}
        보는 중
    {% endif %}
{% else %}
    {{ status_text(item.status) }}
    {% if item.progress %}<span class="progress-muted">@ {{ item.progress }}화</span>{% endif %}
{% endif %}
{% endmacro %}

{% block library_content %}
<p>작품이 {{ count }}개 등록되어 있습니다.</p>

<div class="library-item-list">
{% for key, items in item_groups %}
    <div class="group">
        <h2>{{ key or '?' }}</h2>
        <ul>
        {% for item in items %}
            <li class="item item-{{ item.status }}">
                <a href="{{ url_for('.item_detail', id=item.id) }}">
                    {{ item.title }}
                    <span class="status">{{ render_status(item) }}</span>
                </a>
            </li>
        {% endfor %}
        </ul>
    </div>
{% endfor %}
</div>
{% endblock %}
